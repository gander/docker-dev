#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

cat <<- "EOF" > /tmp/installed-extensions.php
<?php
foreach (array_intersect([
  "amqp",
  "apcu",
  "ast",
  "bcmath",
  "blackfire",
  "bz2",
  "calendar",
  "cmark",
  "core",
  "csv",
  "ctype",
  "curl",
  "date",
  "dba",
  "decimal",
  "dom",
  "ds",
  "enchant",
  "ev",
  "event",
  "excimer",
  "exif",
  "ffi",
  "fileinfo",
  "filter",
  "ftp",
  "gd",
  "gearman",
  "geoip",
  "geospatial",
  "gettext",
  "gmagick",
  "gmp",
  "gnupg",
  "grpc",
  "hash",
  "http",
  "iconv",
  "igbinary",
  "imagick",
  "imap",
  "inotify",
  "interbase",
  "intl",
  "ioncube_loader",
  "jsmin",
  "json",
  "json_post",
  "ldap",
  "libxml",
  "lzf",
  "mailparse",
  "maxminddb",
  "mbstring",
  "mcrypt",
  "memcache",
  "memcached",
  "mongo",
  "mongodb",
  "mosquitto",
  "msgpack",
  "mssql",
  "mysql",
  "mysqli",
  "mysqlnd",
  "oauth",
  "oci8",
  "odbc",
  "opcache",
  "opencensus",
  "openssl",
  "openswoole",
  "parallel",
  "pcntl",
  "pcov",
  "pcre",
  "pdo",
  "pdo_dblib",
  "pdo_firebird",
  "pdo_mysql",
  "pdo_oci",
  "pdo_odbc",
  "pdo_pgsql",
  "pdo_sqlite",
  "pdo_sqlsrv",
  "pgsql",
  "phar",
  "posix",
  "propro",
  "protobuf",
  "pspell",
  "pthreads",
  "raphf",
  "rdkafka",
  "readline",
  "recode",
  "redis",
  "reflection",
  "seaslog",
  "session",
  "shmop",
  "simplexml",
  "smbclient",
  "snmp",
  "snuffleupagus",
  "soap",
  "sockets",
  "sodium",
  "solr",
  "sourceguardian",
  "spl",
  "spx",
  "sqlite3",
  "sqlsrv",
  "ssh2",
  "standard",
  "stomp",
  "swoole",
  "sybase_ct",
  "sysvmsg",
  "sysvsem",
  "sysvshm",
  "tensor",
  "tidy",
  "timezonedb",
  "tokenizer",
  "uopz",
  "uploadprogress",
  "uuid",
  "vips",
  "wddx",
  "xdebug",
  "xhprof",
  "xlswriter",
  "xml",
  "xmldiff",
  "xmlreader",
  "xmlrpc",
  "xmlwriter",
  "xsl",
  "yac",
  "yaml",
  "yar",
  "zephir_parser",
  "zip",
  "zlib",
  "zookeeper",
  "zstd",
], array_map("strtolower", get_loaded_extensions())) as $ext) {
  echo $ext . ": " . (phpversion($ext) ?: '*') . PHP_EOL;
}

EOF

echo
echo
echo "#######################   INSTALLED EXTENSIONS   #######################"
echo
php /tmp/installed-extensions.php
echo
echo "########################################################################"
echo
echo
